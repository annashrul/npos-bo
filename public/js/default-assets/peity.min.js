!function(t,i,e){var s=function(e,s){var h=i.createElementNS("http://www.w3.org/2000/svg",e);return t.each(s,function(t,i){h.setAttribute(t,i)}),h},h="createElementNS"in i&&s("svg",{}).createSVGRect,r=1/(window.devicePixelRatio||1),n=t.fn.peity=function(i,e){return h&&this.each(function(){var s=t(this);if(p=s.data("peity"))i&&(p.type=i),t.extend(p.opts,e);else{var h=n.defaults[i],r={};t.each(s.data(),function(t,i){t in h&&(r[t]=i)});var l=t.extend({},h,r,e),p=new a(s,i,l);s.change(function(){p.draw()}).data("peity",p)}p.draw()}),this},a=function(t,i,e){this.$el=t,this.type=i,this.opts=e},l=a.prototype;l.draw=function(){n.graphers[this.type].call(this,this.opts)},l.fill=function(){var i=this.opts.fill,e=i;return t.isFunction(e)||(e=function(t,e){return i[e%i.length]}),e},l.prepare=function(i,e){var h;return this.svg?h=t(this.svg).empty():(this.svg=s("svg",{class:"peity"}),this.$el.hide().after(this.svg),h=t(this.svg).data("peity",this)),this.svg.setAttribute("height",e),this.svg.setAttribute("width",i),h},l.values=function(){return t.map(this.$el.text().split(this.opts.delimiter),function(t){return parseFloat(t)})},n.defaults={},n.graphers={},n.register=function(t,i,e){this.defaults[t]=i,this.graphers[t]=e},n.register("pie",{delimiter:null,diameter:70,fill:["#ff9900","#fff4dd","#ffc66e"]},function(t){if(!t.delimiter){var i=this.$el.text().match(/[^0-9\.]/);t.delimiter=i?i[0]:","}if(i=this.values(),"/"==t.delimiter)i=[r=i[0],e.max(0,i[1]-r)];for(var h=0,r=i.length,n=0;h<r;h++)n+=i[h];h=(t=this.prepare(t.width||t.diameter,t.height||t.diameter)).width();var a=t.height(),l=(t=h/2,a=a/2,e.min(t,a)),p=e.PI,o=this.fill(),d=-p/2;for(h=0;h<r;h++){var c,f=i[h];if(0!=(u=f/n)){if(1==u)c=s("circle",{cx:t,cy:a,r:l});else{var u=d+(c=2*u*p),g=l*e.cos(d)+t,v=(d=l*e.sin(d)+a,l*e.cos(u)+t),m=l*e.sin(u)+a;c=s("path",{d:["M",t,a,"L",g,d,"A",l,l,0,c>p?1:0,1,v,m,"Z"].join(" ")}),d=u}c.setAttribute("fill",o.call(this,f,h,i)),this.svg.appendChild(c)}}}),n.register("line",{delimiter:",",fill:"#c6d9fd",height:40,max:null,min:0,stroke:"#4d89f9",strokeWidth:1,width:70},function(t){var i=this.values();1==i.length&&i.push(i[0]);for(var h=e.max.apply(e,i.concat([t.max])),r=e.min.apply(e,i.concat([t.min])),n=(a=this.prepare(t.width,t.height)).width(),a=a.height()-t.strokeWidth,l=n/(i.length-1),p=0==(h=h-r)?a:a/h,o=a+r*p,d=(h=[0,o],0);d<i.length;d++)h.push(d*l,a-p*(i[d]-r)+t.strokeWidth/2);h.push(n,o),i=s("polygon",{fill:t.fill,points:h.join(" ")}),this.svg.appendChild(i),t.strokeWidth&&(t=s("polyline",{fill:"transparent",points:h.slice(2,h.length-2).join(" "),stroke:t.stroke,"stroke-width":t.strokeWidth,"stroke-linecap":"square"}),this.svg.appendChild(t))}),n.register("bar",{delimiter:",",fill:["#4D89F9"],gap:1,height:40,max:null,min:0,width:70},function(t){for(var i=this.values(),h=e.max.apply(e,i.concat([t.max])),n=e.min.apply(e,i.concat([t.min])),a=(l=this.prepare(t.width,t.height)).width(),l=l.height(),p=h-n,o=0==p?0:l/p,d=(a=(a+(t=t.gap))/i.length,this.fill()),c=0;c<i.length;c++){var f=i[c],u=l-o*(f-n),g=o*f;0==g?(g=r,(0>=n&&0<h||0==p)&&(u-=r)):0>g&&(u+=g,g=-g),f=s("rect",{fill:d.call(this,f,c,i),x:c*a,y:u,width:a-t,height:g}),this.svg.appendChild(f)}})}(jQuery,document,Math);